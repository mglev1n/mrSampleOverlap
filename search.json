[{"path":"https://mglev1n.github.io/mrSampleOverlap/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 Michael Levin Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/articles/get-started.html","id":"estimate-bias-due-to-sample-overlap","dir":"Articles","previous_headings":"","what":"Estimate bias due to sample overlap","title":"Get started","text":"overall goal package allow user estimate bias due participant overlap Mendelian randomization studies using equations published Burgess et. al. 2016 (DOI: 10.1002/gepi.21998).","code":"# Binary outcome estimate_overlap_bias(   samplesize_exposure = 361194,   samplesize_outcome = 1125328,   case_prop = 0.035,   rsq_exposure = 0.068,   n_variants = 196,   ols_bias = 0.2,   overlap_prop = 0.3 ) #> # A tibble: 1 × 2 #>       bias type1_error #>      <dbl>       <dbl> #> 1 0.000446      0.0501  # Continuous outcome estimate_overlap_bias(   samplesize_exposure = 361194,   samplesize_outcome = 1125328,   rsq_exposure = 0.068,   n_variants = 196,   ols_bias = 0.2,   overlap_prop = 0.3 ) #> # A tibble: 1 × 2 #>       bias type1_error #>      <dbl>       <dbl> #> 1 0.000446      0.0517"},{"path":"https://mglev1n.github.io/mrSampleOverlap/articles/get-started.html","id":"complex-example","dir":"Articles","previous_headings":"Estimate bias due to sample overlap","what":"Complex Example","title":"Get started","text":", use estimate_overlap_bias function complex example, estimate bias across range possible values sample overlap observational bias. First, use TwoSampleMR package query MRC-IEU OpenGWAS Project summary GWAS data use exposure outcome: Next, use TwoSampleMR::add_rsq() add R2 value necessary calculate bias, summarize: can use tidyr::crossing() function generate grid containing range values sample overlap observational bias Finally, can estimate bias MR estimates using estimate_overlap_bias() function: can optionally plot results. see proportion sample overlap increases, type 1 error, bias remains relatively small. Type 1 error bias also magnified bias observational estimate increases:","code":"library(tidyverse) library(TwoSampleMR) library(mrSampleOverlap)  # extract genetic instruments for BMI ldl_exposure <- extract_instruments(outcomes = \"ieu-a-300\")  # extract corresponding outcome data for coronary artery disease cad_outcome <- extract_outcome_data(snps = ldl_exposure$SNP, outcomes = \"ebi-a-GCST005195\")  # harmonize effect alleles, and keep only alleles present in both exposure and outcome data dat_harmonized <- harmonise_data(ldl_exposure, cad_outcome) %>%   filter(mr_keep == TRUE) dat_summarized <- dat_harmonized %>%   add_rsq() %>%   group_by(exposure) %>%   summarize(rsq_exposure = sum(rsq.exposure), n_variants = n(), samplesize_exposure = max(samplesize.exposure), samplesize_outcome = max(samplesize.outcome)) grid <- tidyr::crossing(overlap_prop = seq(0, 1, 0.1),                         ols_bias = seq(0, 1, 0.2)) bias_res <- dat_summarized %>%   crossing(grid) %>%   mutate(res = estimate_overlap_bias(samplesize_exposure = samplesize_exposure, samplesize_outcome = samplesize_outcome, n_variants = n_variants, rsq_exposure = rsq_exposure, overlap_prop = overlap_prop, ols_bias = ols_bias)) %>%   unnest(res) bias_res %>%   split_exposure() %>%   pivot_longer(cols = c(bias, type1_error)) %>%   ggplot(aes(overlap_prop, value, group = ols_bias, color = as.character(ols_bias))) +     geom_point() +     geom_line() +     facet_grid(rows = vars(exposure),                 cols = vars(name),                scales = \"free_y\") +   labs(x = \"Proportion of Overlapping Participants\",        y = \"Value\") +   scale_color_discrete(name = \"Bias in \\nObservational \\nEstimate\") +   theme_bw(base_size = 14)"},{"path":"https://mglev1n.github.io/mrSampleOverlap/articles/get-started.html","id":"estimate-f-statistic","dir":"Articles","previous_headings":"","what":"Estimate F-statistic","title":"Get started","text":"generic function can used estimate F-statistic. Optionally, function return lower limit one-sided 95% confidence interval F-statistic, may represent conservative/less optimistic estimate.","code":"estimate_f(samplesize_exposure = 361194, n_variants = 196, rsq_exposure = 0.068, lci_95 = FALSE) #> [1] 134.3818  # return lower bound of one-sided 95% confidence interval of F-statistic estimate_f(samplesize_exposure = 361194, n_variants = 196, rsq_exposure = 0.068, lci_95 = TRUE) #> [1] 131.624"},{"path":"https://mglev1n.github.io/mrSampleOverlap/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Levin. Author, maintainer.","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Levin M (2022). mrSampleOverlap: Estimate Bias Due Sample Overlap Mendelian Randomization Studies. https://github.com/mglev1n/mrSampleOverlap, https://mglev1n.github.io/mrSampleOverlap/.","code":"@Manual{,   title = {mrSampleOverlap: Estimate Bias Due To Sample Overlap In Mendelian Randomization Studies},   author = {Michael Levin},   year = {2022},   note = {https://github.com/mglev1n/mrSampleOverlap, https://mglev1n.github.io/mrSampleOverlap/}, }"},{"path":"https://mglev1n.github.io/mrSampleOverlap/index.html","id":"mrsampleoverlap","dir":"","previous_headings":"","what":"Estimate Bias Due To Sample Overlap In Mendelian Randomization\n    Studies","title":"Estimate Bias Due To Sample Overlap In Mendelian Randomization\n    Studies","text":"goal mrSampleOverlap estimate bias due participant overlap Mendelian Randomization studies. package implements code described Burgess et. al. 2016 (DOI: 10.1002/gepi.21998)","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Estimate Bias Due To Sample Overlap In Mendelian Randomization\n    Studies","text":"can install development version mrSampleOverlap GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"mglev1n/mrSampleOverlap\")"},{"path":"https://mglev1n.github.io/mrSampleOverlap/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Estimate Bias Due To Sample Overlap In Mendelian Randomization\n    Studies","text":", use estimate_overlap_bias function complex example, estimate bias across range possible values sample overlap observational bias. First, use TwoSampleMR package query MRC-IEU OpenGWAS Project summary GWAS data use exposure outcome: Next, use TwoSampleMR::add_rsq() add R2 value necessary calculate bias, summarize: can use tidyr::crossing() function generate grid containing range values sample overlap observational bias Finally, can estimate bias MR estimates using estimate_overlap_bias() function: can optionally plot results. see proportion sample overlap increases, type 1 error, bias remains relatively small. Type 1 error bias also magnified bias observational estimate increases:","code":"# devtools::install_github(\"MRCIEU/TwoSampleMR\") # install.packages(\"tidyverse\")  library(tidyverse) library(TwoSampleMR) library(mrSampleOverlap)  # extract genetic instruments for BMI ldl_exposure <- extract_instruments(outcomes = \"ieu-a-300\")  # extract corresponding outcome data for coronary artery disease cad_outcome <- extract_outcome_data(snps = ldl_exposure$SNP, outcomes = \"ebi-a-GCST005195\")  # harmonize effect alleles, and keep only alleles present in both exposure and outcome data dat_harmonized <- harmonise_data(ldl_exposure, cad_outcome) %>%   filter(mr_keep == TRUE) dat_summarized <- dat_harmonized %>%   add_rsq() %>%   group_by(exposure) %>%   summarize(rsq_exposure = sum(rsq.exposure), n_variants = n(), samplesize_exposure = max(samplesize.exposure), samplesize_outcome = max(samplesize.outcome)) grid <- tidyr::crossing(overlap_prop = seq(0, 1, 0.1),                         ols_bias = seq(0, 1, 0.2)) bias_res <- dat_summarized %>%   crossing(grid) %>%   mutate(res = estimate_overlap_bias(samplesize_exposure = samplesize_exposure, samplesize_outcome = samplesize_outcome, n_variants = n_variants, rsq_exposure = rsq_exposure, overlap_prop = overlap_prop, ols_bias = ols_bias)) %>%   unnest(res) bias_res %>%   split_exposure() %>%   pivot_longer(cols = c(bias, type1_error)) %>%   ggplot(aes(overlap_prop, value, group = ols_bias, color = as.character(ols_bias))) +     geom_point() +     geom_line() +     facet_grid(rows = vars(exposure),                 cols = vars(name),                scales = \"free_y\") +   labs(x = \"Proportion of Overlapping Participants\",        y = \"Value\") +   scale_color_discrete(name = \"Bias in \\nObservational \\nEstimate\") +   theme_bw(base_size = 14)"},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/estimate_f.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate F-statistic — estimate_f","title":"Estimate F-statistic — estimate_f","text":"Estimate F-statistic","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/estimate_f.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate F-statistic — estimate_f","text":"","code":"estimate_f(samplesize_exposure, n_variants, rsq_exposure, lci_95 = FALSE)"},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/estimate_f.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate F-statistic — estimate_f","text":"samplesize_exposure (numeric) Sample size population used define genetic instrument exposure interest n_variants (numeric) Number genetic variants included genetic instrument exposure interest rsq_exposure (numeric) \\(R^2\\) value (coefficient determination) genetic instrument exposure interest; used estimate lci_95 (logical; default = FALSE) TRUE, function return lower limit one-sided 95% confidence interval F-statistic, may represent conservative/less optimistic estimate","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/estimate_f.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate F-statistic — estimate_f","text":"Numeric vector containing estimated F-statistic","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/estimate_f.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate F-statistic — estimate_f","text":"","code":"estimate_f(samplesize_exposure = 361194, n_variants = 196, rsq_exposure = 0.068, lci_95 = FALSE) #> [1] 134.3818  # return lower bound of one-sided 95% confidence interval of F-statistic estimate_f(samplesize_exposure = 361194, n_variants = 196, rsq_exposure = 0.068, lci_95 = TRUE) #> [1] 131.624"},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/estimate_overlap_bias.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate bias due to sample overlap — estimate_overlap_bias","title":"Estimate bias due to sample overlap — estimate_overlap_bias","text":"Estimate bias due sample overlap","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/estimate_overlap_bias.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate bias due to sample overlap — estimate_overlap_bias","text":"","code":"estimate_overlap_bias(   samplesize_exposure,   samplesize_outcome,   n_variants,   rsq_exposure,   exp_f = NULL,   lci_95 = FALSE,   case_prop = 0,   ols_bias,   overlap_prop,   var_x = 1,   var_y = 1 )"},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/estimate_overlap_bias.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate bias due to sample overlap — estimate_overlap_bias","text":"samplesize_exposure (numeric) Sample size population used define genetic instrument exposure interest samplesize_outcome (numeric) Sample size population used outcome interest n_variants (numeric) Number genetic variants included genetic instrument exposure interest rsq_exposure (numeric) \\(R^2\\) value (coefficient determination) genetic instrument exposure interest; used estimate F-statistic exp_f (numeric; optional) F-statistic genetic instrument (provided, value used, rather estimate based \\(R^2\\)) lci_95 (logical; default = FALSE) TRUE, function return estimates bias type 1 error based lower limit one-sided 95% confidence interval F-statistic, may represent conservative/less optimistic estimate bias case_prop (numeric; optional) Proportion cases (eg. cases/total samplesize) outcome binary ols_bias (numeric) Observational (biased) effect estimate (known); otherwise, provide hypothetical value overlap_prop (numeric; range = 0 1) Proportion overlapping samples exposure outcome studies (known); otherwise, provide hypothetical value var_x (numeric) Variance exposure; default 1 exposure reported standard deviation units var_y (numeric) Variance exposure; default 1 exposure reported standard deviation units","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/estimate_overlap_bias.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate bias due to sample overlap — estimate_overlap_bias","text":"tibble containing columns bias type1_error","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/estimate_overlap_bias.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate bias due to sample overlap — estimate_overlap_bias","text":"","code":"# Binary outcome estimate_overlap_bias(   samplesize_exposure = 361194,   samplesize_outcome = 1125328,   case_prop = 0.035,   rsq_exposure = 0.068,   n_variants = 196,   ols_bias = 0.2,   overlap_prop = 0.3 ) #> # A tibble: 1 × 2 #>       bias type1_error #>      <dbl>       <dbl> #> 1 0.000446      0.0501  # Continuous outcome estimate_overlap_bias(   samplesize_exposure = 361194,   samplesize_outcome = 1125328,   rsq_exposure = 0.068,   n_variants = 196,   ols_bias = 0.2,   overlap_prop = 0.3 ) #> # A tibble: 1 × 2 #>       bias type1_error #>      <dbl>       <dbl> #> 1 0.000446      0.0517"},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/mrSampleOverlap-package.html","id":null,"dir":"Reference","previous_headings":"","what":"mrSampleOverlap: Estimate Bias Due To Sample Overlap In Mendelian Randomization Studies — mrSampleOverlap-package","title":"mrSampleOverlap: Estimate Bias Due To Sample Overlap In Mendelian Randomization Studies — mrSampleOverlap-package","text":"function estimate bias due sample overlap Mendelian Randomization studies.","code":""},{"path":[]},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/mrSampleOverlap-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"mrSampleOverlap: Estimate Bias Due To Sample Overlap In Mendelian Randomization Studies — mrSampleOverlap-package","text":"Maintainer: Michael Levin michael.levin@pennmedicine.upenn.edu (ORCID)","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://mglev1n.github.io/mrSampleOverlap/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""}]
